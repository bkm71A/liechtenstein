{"paragraphs":[{"title":"Defining a bidding_bundle table","text":"val biddingSessions = sqlc\r\n  .read\r\n  .format(\"org.apache.spark.sql.cassandra\")\r\n  .options(Map( \"table\" -> \"bidding_bundle\", \"keyspace\" -> \"mss\"))\r\n  .load()\r\n  \r\nbiddingSessions.registerTempTable(\"bidding_bundle\")","authenticationInfo":{},"dateUpdated":"Jun 6, 2016 9:55:36 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","editorHide":true,"tableHide":true,"title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464730906638_-392495763","id":"20160531-214146_1800256238","result":{"code":"SUCCESS","type":"TEXT","msg":"biddingSessions: org.apache.spark.sql.DataFrame = [ipinyou_id: string, ts: timestamp, bid_id: string, ad_exchange: smallint, ad_slot_format: string, ad_slot_height: int, ad_slot_id: string, ad_slot_visibility: int, ad_slot_width: int, advertiser_id: int, anonymous_url: string, bidding_price: decimal(38,18), city: int, creative_id: string, domain: string, ext_ad_exchange: struct<id:smallint,name:string,description:string>, ext_city: struct<id:int,name:string,state_id:int,population:int,area:float,density:float,latitude:float,longitude:float>, ext_log_type: struct<id:int,name:string>, ext_state: struct<id:int,name:string,population:int,gsp:int>, ext_user_agent: struct<ua_type:string,ua_family:string,os_name:string,device:string>, ext_user_tags: struct<id:bigint,keywords:array<string>,stat..."},"dateCreated":"May 31, 2016 9:41:46 PM","dateStarted":"Jun 6, 2016 8:02:59 AM","dateFinished":"Jun 6, 2016 8:03:02 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1078"},{"title":"Paying price SUM by category","text":"%sql\nSELECT kwc, sum(paying_price) paying_price\nFROM bidding_bundle \nLATERAL VIEW explode(keyword_categories) t as kwc \nWHERE size(keyword_categories) > 0\nGROUP BY kwc\nORDER BY sum(paying_price) desc\nLIMIT 10","authenticationInfo":{},"dateUpdated":"Jun 6, 2016 9:55:47 AM","config":{"colWidth":4,"graph":{"mode":"pieChart","height":510,"optionOpen":false,"keys":[{"name":"kwc","index":0,"aggr":"sum"}],"values":[{"name":"paying_price","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"kwc","index":0,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql","editorHide":true,"title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464946093289_-1832006724","id":"20160603-092813_1121082304","result":{"code":"SUCCESS","type":"TABLE","msg":"kwc\tpaying_price\nrearview\t26397396.000000000000000000\nchevrolet\t25259239.000000000000000000\nungrouped\t4781334.000000000000000000\ncar\t3149073.000000000000000000\naccessories\t2917078.000000000000000000\naccessoires\t2844817.000000000000000000\nassorted\t1444530.000000000000000000\ncalling\t1331192.000000000000000000\nantenna\t1255103.000000000000000000\ntheft\t1176836.000000000000000000\n","comment":"","msgTable":[[{"key":"paying_price","value":"rearview"},{"key":"paying_price","value":"26397396.000000000000000000"}],[{"value":"chevrolet"},{"value":"25259239.000000000000000000"}],[{"value":"ungrouped"},{"value":"4781334.000000000000000000"}],[{"value":"car"},{"value":"3149073.000000000000000000"}],[{"value":"accessories"},{"value":"2917078.000000000000000000"}],[{"value":"accessoires"},{"value":"2844817.000000000000000000"}],[{"value":"assorted"},{"value":"1444530.000000000000000000"}],[{"value":"calling"},{"value":"1331192.000000000000000000"}],[{"value":"antenna"},{"value":"1255103.000000000000000000"}],[{"value":"theft"},{"value":"1176836.000000000000000000"}]],"columnNames":[{"name":"kwc","index":0,"aggr":"sum"},{"name":"paying_price","index":1,"aggr":"sum"}],"rows":[["rearview","26397396.000000000000000000"],["chevrolet","25259239.000000000000000000"],["ungrouped","4781334.000000000000000000"],["car","3149073.000000000000000000"],["accessories","2917078.000000000000000000"],["accessoires","2844817.000000000000000000"],["assorted","1444530.000000000000000000"],["calling","1331192.000000000000000000"],["antenna","1255103.000000000000000000"],["theft","1176836.000000000000000000"]]},"dateCreated":"Jun 3, 2016 9:28:13 AM","dateStarted":"Jun 6, 2016 8:03:30 AM","dateFinished":"Jun 6, 2016 8:03:46 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1080"},{"title":"Preparing table","text":"%sql\nSELECT week_start,\n    SUM(paying_price) sum_payed,\n    SUM(bidding_price) sum_bidded\nFROM (\n    SELECT \n        next_day(date_add(to_date(ts), -7), 'MO') week_start,\n        ts,\n        paying_price,\n        bidding_price\n    FROM bidding_bundle\n    WHERE ts > \"2013-06-06\" AND ts < \"2013-06-13\"\n) t    \nGROUP BY week_start\nORDER BY week_start","authenticationInfo":{},"dateUpdated":"Jun 6, 2016 9:55:58 AM","config":{"colWidth":8,"graph":{"mode":"multiBarChart","height":506,"optionOpen":false,"keys":[{"name":"week_start","index":0,"aggr":"sum"}],"values":[{"name":"sum_payed","index":1,"aggr":"sum"},{"name":"sum_bidded","index":2,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"week_start","index":0,"aggr":"sum"}}},"enabled":true,"editorHide":true,"editorMode":"ace/mode/sql","title":true},"settings":{"params":{"startDate":""},"forms":{}},"jobName":"paragraph_1464946209481_208452966","id":"20160603-093009_1946449613","result":{"code":"SUCCESS","type":"TABLE","msg":"week_start\tsum_payed\tsum_bidded\n2013-06-03\t68274968.000000000000000000\t463239906.000000000000000000\n2013-06-10\t572254.000000000000000000\t3368802.000000000000000000\n","comment":"","msgTable":[[{"key":"sum_payed","value":"2013-06-03"},{"key":"sum_payed","value":"68274968.000000000000000000"},{"key":"sum_payed","value":"463239906.000000000000000000"}],[{"key":"sum_bidded","value":"2013-06-10"},{"key":"sum_bidded","value":"572254.000000000000000000"},{"key":"sum_bidded","value":"3368802.000000000000000000"}]],"columnNames":[{"name":"week_start","index":0,"aggr":"sum"},{"name":"sum_payed","index":1,"aggr":"sum"},{"name":"sum_bidded","index":2,"aggr":"sum"}],"rows":[["2013-06-03","68274968.000000000000000000","463239906.000000000000000000"],["2013-06-10","572254.000000000000000000","3368802.000000000000000000"]]},"dateCreated":"Jun 3, 2016 9:30:09 AM","dateStarted":"Jun 6, 2016 9:53:50 AM","dateFinished":"Jun 6, 2016 9:54:10 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1081","focus":true},{"authenticationInfo":{},"dateUpdated":"Jun 6, 2016 8:02:59 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1464963861638_1732345442","id":"20160603-142421_1549303837","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Jun 3, 2016 2:24:21 PM","dateStarted":"Jun 6, 2016 8:03:04 AM","dateFinished":"Jun 6, 2016 8:03:30 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1083"}],"name":"[MSS-DWH] Cash Flow","id":"2BKR6663C","angularObjects":{"2BFJ2NS5Z":[],"2BBXSPPGE":[],"2BC4MD68G":[],"2BCA5VUSP":[],"2BCP5YMKK":[],"2BDZVA7DF":[],"2BE47DYQY":[],"2BES4SCXE":[],"2BCVWFK97":[],"2BE2PGV8Y":[{"name":"endDate","object":"2013-06-13","noteId":"2BKR6663C"},{"name":"endtime","object":"","noteId":"2BKR6663C"},{"name":"starttime","object":"2016-06-14T20:00:00.000Z","noteId":"2BKR6663C"},{"name":"userId","object":"1234","noteId":"2BKR6663C"},{"name":"startDate","object":"2013-06-06","noteId":"2BKR6663C"}],"2BECFME3Z":[],"2BDH4D92N":[],"2BF329QF6":[]},"config":{"looknfeel":"default"},"info":{}}